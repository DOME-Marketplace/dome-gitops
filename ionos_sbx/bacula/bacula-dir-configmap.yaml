apiVersion: v1
kind: ConfigMap
metadata:
  name: bacula-config
  namespace: bacula
data:
  bacula-dir.conf: |
    #
    # Bacula Director Configuration
    #
    Director {
      Name = bacula-dir
      DIRport = 9101
      QueryFile = "/opt/bacula/scripts/query.sql"
      WorkingDirectory = "/opt/bacula/working"
      PidDirectory = "/opt/bacula/working"
      Maximum Concurrent Jobs = 300
      Password = "bacula" # Console password
      Messages = Daemon
    }

    Client {
      Name = bacula-fd
      Address = bacula-fd
      FDPort = 9102
      Catalog = MyCatalog
      Password = "bacula"
      File Retention = 60 days
      Job Retention = 6 months
      AutoPrune = yes
    }

    Storage {
      Name = File1
      Address = bacula-sd
      SDPort = 9103
      Device = FileChgr1
      MediaType = File1
      Password = "bacula"
    }

    Catalog {
      Name = MyCatalog
      dbdriver = "postgresql"
      dbaddress = bacula-db
      dbport = 5432
      dbname = "bacula"
      dbuser = "bacula"
      dbpassword = "bacula"
    }

    Messages {
      Name = Daemon
      console = all, !skipped, !saved
      stdout = all, !skipped
    }

    Pool {
      Name = Default
      Pool Type = Backup
      Recycle = yes
      AutoPrune = yes
      Volume Retention = 365 days
      Maximum Volume Bytes = 50G
      Maximum Volumes = 100
    }

    Pool {
      Name = File
      Pool Type = Backup
      Recycle = yes
      AutoPrune = yes
      Volume Retention = 365 days
      Maximum Volume Bytes = 50G
      Maximum Volumes = 100
      Label Format = "Vol-"
    }

  bacula-fd.conf: |
    #
    # Bacula File Daemon Configuration
    #
    FileDaemon {
      Name = bacula-fd
      FDport = 9102
      WorkingDirectory = /opt/bacula/working
      PidDirectory = /opt/bacula/working
      Maximum Concurrent Jobs = 20
    }

    Director {
      Name = bacula-dir
      Password = "bacula"
    }

    Messages {
      Name = Standard
      director = bacula-dir = all
    }

  bacula-sd.conf: |
    #
    # Bacula Storage Daemon Configuration
    #
    Director {
      Name = bacula-dir
      Password = "bacula"
    }

    Device {
      Name = FileChgr1
      MediaType = File1
      ArchiveDevice = /backups          # Directory for storing backups
      LabelMedia = yes                  # Automatically label new media
      RandomAccess = yes                # Enables random access to files
      AutomaticMount = yes              # Automatically mount media
      RemovableMedia = no               # Set to 'yes' for removable drives/tapes
      AlwaysOpen = no                   # Set to 'yes' for persistent device access
    }

    Messages {
      Name = Standard
      director = bacula-dir = all
    }

  bconsole.conf: |
    #
    # Bacula Console Configuration
    #
    Director {
      Name = bacula-dir
      DIRport = 9101
      Password = "bacula"
    }

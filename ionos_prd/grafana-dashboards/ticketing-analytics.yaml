apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    grafana_dashboard: "1"
  name: ticketing-analytics
data:
  ticketing-analytics.json: |-
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": {
              "type": "grafana",
              "uid": "-- Grafana --"
            },
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 0,
      "links": [],
      "panels": [
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 10
                  },
                  {
                    "color": "red",
                    "value": 30
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 13,
            "w": 15,
            "x": 0,
            "y": 0
          },
          "id": 1,
          "options": {
            "displayMode": "basic",
            "maxVizHeight": 300,
            "minVizHeight": 16,
            "minVizWidth": 8,
            "namePlacement": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": true
            },
            "showUnfilled": true,
            "sizing": "auto",
            "valueMode": "color"
          },
          "pluginVersion": "11.0.0",
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "SELECT\r\n    g.name AS group_name,\r\n    COUNT(CASE WHEN t.state_id NOT IN (4, 7) THEN 1 END) AS \"OPEN TICKETS\"\r\nFROM\r\n    tickets t\r\nRIGHT JOIN\r\n    groups g ON t.group_id = g.id\r\nWHERE\r\n    g.id IN (3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 17, 18, 27, 29)\r\nGROUP BY\r\n    g.name\r\nORDER BY\r\n    g.name ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "OPEN TICKETS BY COMPETENCE CENTER",
          "type": "bargauge"
        },
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "fillOpacity": 80,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineWidth": 1,
                "scaleDistribution": {
                  "type": "linear"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 15,
            "w": 22,
            "x": 0,
            "y": 13
          },
          "id": 3,
          "options": {
            "barRadius": 0,
            "barWidth": 0.97,
            "fullHighlight": false,
            "groupWidth": 0.7,
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "orientation": "auto",
            "showValue": "auto",
            "stacking": "none",
            "tooltip": {
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            },
            "xTickLabelRotation": 0,
            "xTickLabelSpacing": 0
          },
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "SELECT\r\n    g.name AS group_name,\r\n    COUNT(CASE WHEN t.state_id NOT IN (4, 7) AND t.escalation_at IS NOT NULL AND t.escalation_at <= NOW() THEN 1 END) AS \"ESCALATED TICKETS\",\r\n    ROUND(MAX(CASE WHEN t.state_id NOT IN (4, 7) AND t.escalation_at IS NOT NULL AND t.escalation_at <= NOW() THEN EXTRACT(EPOCH FROM (NOW() - t.escalation_at)) / 86400 END)) AS \"MAX ESCALATION TIME (DAYS)\"\r\nFROM\r\n    tickets t\r\nRIGHT JOIN\r\n    groups g ON t.group_id = g.id\r\nWHERE\r\n    g.id IN (3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 17, 18, 27, 29)\r\nGROUP BY\r\n    g.name\r\nHAVING\r\n    COUNT(CASE WHEN t.state_id NOT IN (4, 7) AND t.escalation_at IS NOT NULL AND t.escalation_at <= NOW() THEN 1 END) > 0\r\nORDER BY\r\n    g.name ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "ESCALATED TICKET BY COMPETENCE CENTER",
          "type": "barchart"
        },
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "max": 180,
              "min": 0,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "#EAB839",
                    "value": 20
                  },
                  {
                    "color": "red",
                    "value": 30
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 10,
            "w": 10,
            "x": 0,
            "y": 28
          },
          "id": 7,
          "options": {
            "displayMode": "basic",
            "maxVizHeight": 300,
            "minVizHeight": 16,
            "minVizWidth": 8,
            "namePlacement": "auto",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": true
            },
            "showUnfilled": true,
            "sizing": "auto",
            "valueMode": "color"
          },
          "pluginVersion": "11.0.0",
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "SELECT\r\n    g.name AS group_name,\r\n    ROUND(AVG(EXTRACT(EPOCH FROM NOW() - t.created_at) / 86400)) AS \"AVERAGE TICKET AGE (DAYS)\"\r\nFROM\r\n    groups g\r\nLEFT JOIN\r\n    tickets t ON t.group_id = g.id\r\n    AND t.state_id NOT IN (3, 4, 7)  \r\nWHERE\r\n    g.id IN (3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 17, 18, 27, 29)\r\n    AND t.id IS NOT NULL  \r\nGROUP BY\r\n    g.name\r\nHAVING\r\n    ROUND(AVG(EXTRACT(EPOCH FROM NOW() - t.created_at) / 86400)) > 0 \r\nORDER BY\r\n    g.name ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "AVERAGE OPEN TICKET AGE BY COMPETENCE CENTER (IN DAYS)",
          "type": "bargauge"
        },
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "COMPETENCE CENTER"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 253
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "MORE THAN 30 DAYS"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 187
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 16,
            "w": 19,
            "x": 0,
            "y": 38
          },
          "id": 11,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.0.0",
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "WITH ticket_state_count AS (\r\n  SELECT \r\n    group_id,\r\n    COUNT(*) AS tickets_state_not_4_7\r\n  FROM tickets\r\n  WHERE state_id NOT IN (4,7)\r\n  GROUP BY group_id\r\n)\r\nSELECT\r\n  g.name AS \"COMPETENCE CENTER\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) <= INTERVAL '1 day') AS \"LESS THAN 1 DAY\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '1 day'\r\n                   AND (t.last_close_at - t.created_at) <= INTERVAL '7 days') AS \"2 TO 7 DAYS\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '7 days'\r\n                   AND (t.last_close_at - t.created_at) <= INTERVAL '14 days') AS \"8 TO 14 DAYS\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '14 days'\r\n                   AND (t.last_close_at - t.created_at) <= INTERVAL '30 days') AS \"15 TO 30 DAYS\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '30 days') AS \"MORE THAN 30 DAYS\",\r\n  COALESCE(tsc.tickets_state_not_4_7, 0) AS \"STILL OPEN\"\r\nFROM groups g\r\nLEFT JOIN tickets t ON t.group_id = g.id\r\n  AND t.state_id = 4\r\n  AND t.last_close_at IS NOT NULL\r\n  AND t.created_at IS NOT NULL\r\n  AND t.last_close_at >= NOW() - INTERVAL '30 days'\r\nLEFT JOIN ticket_state_count tsc ON tsc.group_id = g.id\r\nWHERE g.id IN (3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 17, 18, 27, 29)\r\nGROUP BY g.name, tsc.tickets_state_not_4_7\r\nORDER BY g.name ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "RESOLUTION TIME FOR TICKETS CLOSED IN THE LAST 30 DAYS",
          "type": "table"
        },
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "MORE THAN 30 DAYS"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 184
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "2 TO 7 DAYS"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 127
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "8 TO 14 DAYS"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 124
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "15 TO 30 DAYS"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 138
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 16,
            "w": 19,
            "x": 0,
            "y": 54
          },
          "id": 12,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.0.0",
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "WITH ticket_state_count AS ( \r\n  SELECT \r\n    group_id,\r\n    severity,\r\n    COUNT(*) AS tickets_state_not_4_7\r\n  FROM tickets\r\n  WHERE state_id NOT IN (4,7)\r\n    AND severity <> '5'\r\n  GROUP BY group_id, severity\r\n)\r\nSELECT\r\n  g.name || ' - ' || s.severity_name AS \"COMPETENCE CENTER\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) <= INTERVAL '1 day') AS \"LESS THAN 1 DAY\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '1 day'\r\n                   AND (t.last_close_at - t.created_at) <= INTERVAL '7 days') AS \"2 TO 7 DAYS\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '7 days'\r\n                   AND (t.last_close_at - t.created_at) <= INTERVAL '14 days') AS \"8 TO 14 DAYS\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '14 days'\r\n                   AND (t.last_close_at - t.created_at) <= INTERVAL '30 days') AS \"15 TO 30 DAYS\",\r\n  COUNT(t.id) FILTER (WHERE (t.last_close_at - t.created_at) > INTERVAL '30 days') AS \"MORE THAN 30 DAYS\",\r\n  COALESCE(tsc.tickets_state_not_4_7, 0) AS \"STILL OPEN\"\r\nFROM groups g\r\nCROSS JOIN LATERAL (VALUES \r\n    ('1', 'Critical'),\r\n    ('2', 'Major'),\r\n    ('3', 'Moderate'),\r\n    ('4', 'Minor')\r\n) AS s(severity, severity_name)\r\nLEFT JOIN tickets t ON t.group_id = g.id\r\n  AND t.state_id = 4\r\n  AND t.severity = s.severity\r\n  AND t.severity <> '5'\r\n  AND t.last_close_at IS NOT NULL\r\n  AND t.created_at IS NOT NULL\r\n  AND t.last_close_at >= NOW() - INTERVAL '30 days'\r\nLEFT JOIN ticket_state_count tsc \r\n  ON tsc.group_id = g.id \r\n  AND tsc.severity = s.severity\r\nWHERE g.id IN (3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 17, 18, 27, 29)\r\nGROUP BY g.name, s.severity, s.severity_name, tsc.tickets_state_not_4_7\r\nHAVING \r\n    COALESCE(SUM(CASE WHEN (t.last_close_at - t.created_at) <= INTERVAL '1 day' THEN 1 ELSE 0 END), 0)\r\n  + COALESCE(SUM(CASE WHEN (t.last_close_at - t.created_at) > INTERVAL '1 day' AND (t.last_close_at - t.created_at) <= INTERVAL '7 days' THEN 1 ELSE 0 END), 0)\r\n  + COALESCE(SUM(CASE WHEN (t.last_close_at - t.created_at) > INTERVAL '7 days' AND (t.last_close_at - t.created_at) <= INTERVAL '14 days' THEN 1 ELSE 0 END), 0)\r\n  + COALESCE(SUM(CASE WHEN (t.last_close_at - t.created_at) > INTERVAL '14 days' AND (t.last_close_at - t.created_at) <= INTERVAL '30 days' THEN 1 ELSE 0 END), 0)\r\n  + COALESCE(SUM(CASE WHEN (t.last_close_at - t.created_at) > INTERVAL '30 days' THEN 1 ELSE 0 END), 0)\r\n  + COALESCE(tsc.tickets_state_not_4_7, 0) > 0\r\nORDER BY g.name ASC, s.severity::int ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "RESOLUTION TIME FOR TICKETS CLOSED IN THE LAST 30 DAYS (BY SEVERITY)",
          "type": "table"
        },
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "fillOpacity": 80,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineWidth": 1,
                "scaleDistribution": {
                  "type": "linear"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 17,
            "w": 16,
            "x": 0,
            "y": 70
          },
          "id": 8,
          "options": {
            "barRadius": 0,
            "barWidth": 0.97,
            "fullHighlight": false,
            "groupWidth": 0.7,
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "orientation": "auto",
            "showValue": "auto",
            "stacking": "none",
            "tooltip": {
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            },
            "xTickLabelRotation": 0,
            "xTickLabelSpacing": 0
          },
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "WITH intervals AS (\r\n    SELECT \r\n        generate_series(\r\n            DATE_TRUNC('week', NOW()), \r\n            DATE_TRUNC('week', NOW()) - INTERVAL '25 days', \r\n            '-7 days'\r\n        ) AS week_start\r\n)\r\nSELECT \r\n    intervals.week_start,\r\n    COUNT(*) FILTER (WHERE group_id = 18) AS \"01 - Marketing Activities\",\r\n    COUNT(*) FILTER (WHERE group_id = 27) AS \"02 - Project Website\",\r\n    COUNT(*) FILTER (WHERE group_id = 11) AS \"03 - Privacy & Legal\",\r\n    COUNT(*) FILTER (WHERE group_id = 4) AS \"04 - Credential Management\",\r\n    COUNT(*) FILTER (WHERE group_id = 5) AS \"05 - Dome Marketplace\",\r\n    COUNT(*) FILTER (WHERE group_id = 29) AS \"06 - Chatbot\",\r\n    COUNT(*) FILTER (WHERE group_id = 17) AS \"07 - Dome Search\",\r\n    COUNT(*) FILTER (WHERE group_id = 8) AS \"08 - Billing & Invoicing\",\r\n    COUNT(*) FILTER (WHERE group_id = 9) AS \"09 - Payment System\",\r\n    COUNT(*) FILTER (WHERE group_id = 3) AS \"10 - Offering Qualification Process\",\r\n    COUNT(*) FILTER (WHERE group_id = 7) AS \"11 - Integration and Replica\",\r\n    COUNT(*) FILTER (WHERE group_id = 12) AS \"12 - Infrastructure\",\r\n    COUNT(*) FILTER (WHERE group_id = 6) AS \"13 - DevOps Deployments\",       \r\n    COUNT(*) FILTER (WHERE group_id = 10) AS \"14 - Customer Care\"\r\nFROM \r\n    intervals\r\nLEFT JOIN \r\n    tickets \r\nON \r\n    tickets.created_at >= intervals.week_start\r\n    AND tickets.created_at < intervals.week_start + INTERVAL '7 days'\r\nGROUP BY \r\n    intervals.week_start\r\nORDER BY \r\n    intervals.week_start ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "OPENED TICKETS TREND",
          "type": "barchart"
        },
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "fillOpacity": 80,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineWidth": 1,
                "scaleDistribution": {
                  "type": "linear"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 16,
            "x": 0,
            "y": 87
          },
          "id": 9,
          "options": {
            "barRadius": 0,
            "barWidth": 0.97,
            "fullHighlight": false,
            "groupWidth": 0.7,
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "orientation": "auto",
            "showValue": "auto",
            "stacking": "none",
            "tooltip": {
              "maxHeight": 600,
              "mode": "single",
              "sort": "none"
            },
            "xTickLabelRotation": 0,
            "xTickLabelSpacing": 0
          },
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "WITH intervals AS (\r\n    SELECT \r\n        generate_series(\r\n            DATE_TRUNC('week', NOW()), \r\n            DATE_TRUNC('week', NOW()) - INTERVAL '25 days', \r\n            '-7 days'\r\n        ) AS week_start\r\n)\r\nSELECT \r\n    intervals.week_start,\r\n    COUNT(*) FILTER (WHERE group_id = 18) AS \"01 - Marketing Activities\",\r\n    COUNT(*) FILTER (WHERE group_id = 27) AS \"02 - Project Website\",\r\n    COUNT(*) FILTER (WHERE group_id = 11) AS \"03 - Privacy & Legal\",\r\n    COUNT(*) FILTER (WHERE group_id = 4) AS \"04 - Credential Management\",\r\n    COUNT(*) FILTER (WHERE group_id = 5) AS \"05 - Dome Marketplace\",\r\n    COUNT(*) FILTER (WHERE group_id = 29) AS \"06 - Chatbot\",\r\n    COUNT(*) FILTER (WHERE group_id = 17) AS \"07 - Dome Search\",\r\n    COUNT(*) FILTER (WHERE group_id = 8) AS \"08 - Billing & Invoicing\",\r\n    COUNT(*) FILTER (WHERE group_id = 9) AS \"09 - Payment System\",\r\n    COUNT(*) FILTER (WHERE group_id = 3) AS \"10 - Offering Qualification Process\",\r\n    COUNT(*) FILTER (WHERE group_id = 7) AS \"11 - Integration and Replica\",\r\n    COUNT(*) FILTER (WHERE group_id = 12) AS \"12 - Infrastructure\",\r\n    COUNT(*) FILTER (WHERE group_id = 6) AS \"13 - DevOps Deployments\",       \r\n    COUNT(*) FILTER (WHERE group_id = 10) AS \"14 - Customer Care\"\r\nFROM \r\n    intervals\r\nLEFT JOIN \r\n    tickets \r\nON \r\n    tickets.last_close_at >= intervals.week_start\r\n    AND tickets.last_close_at < intervals.week_start + INTERVAL '7 days'\r\nGROUP BY \r\n    intervals.week_start\r\nORDER BY \r\n    intervals.week_start ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "CLOSED TICKETS TREND",
          "type": "barchart"
        },
        {
          "datasource": {
            "type": "grafana-postgresql-datasource",
            "uid": "P68D0D9E587DEE267"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "auto",
                "cellOptions": {
                  "type": "auto"
                },
                "inspect": false
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "interventions 14-21 days ago"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 218
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "interventions 7-14 days ago"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 224
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "interventions last 7 days"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 209
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "INTERVENTIONS LAST 7 DAYS"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 237
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "INTERVENTIONS 28-21 DAYS AGO"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 227
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "INTERVENTIONS 21-14 DAYS AGO"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 261
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "INTERVENTIONS 14-7 DAYS AGO"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 256
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 25,
            "w": 18,
            "x": 0,
            "y": 99
          },
          "id": 13,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.0.0",
          "targets": [
            {
              "datasource": {
                "type": "grafana-postgresql-datasource",
                "uid": "P68D0D9E587DEE267"
              },
              "editorMode": "code",
              "format": "table",
              "rawQuery": true,
              "rawSql": "SELECT\r\n    o.name,\r\n    COUNT(DISTINCT CASE \r\n        WHEN ta.created_at < NOW() - INTERVAL '21 days'\r\n         AND ta.created_at >= NOW() - INTERVAL '28 days' THEN t.number\r\n    END) AS \"INTERVENTIONS 28-21 DAYS AGO\",\r\n    COUNT(DISTINCT CASE \r\n        WHEN ta.created_at < NOW() - INTERVAL '14 days'\r\n         AND ta.created_at >= NOW() - INTERVAL '21 days' THEN t.number\r\n    END) AS \"INTERVENTIONS 21-14 DAYS AGO\",\r\n    COUNT(DISTINCT CASE \r\n        WHEN ta.created_at < NOW() - INTERVAL '7 days'\r\n         AND ta.created_at >= NOW() - INTERVAL '14 days' THEN t.number\r\n    END) AS \"INTERVENTIONS 14-7 DAYS AGO\",\r\n    COUNT(DISTINCT CASE \r\n        WHEN ta.created_at >= NOW() - INTERVAL '7 days' THEN t.number\r\n    END) AS \"INTERVENTIONS LAST 7 DAYS\"  \r\n    \r\nFROM ticket_articles ta\r\nJOIN tickets t ON ta.ticket_id = t.id\r\nJOIN users u ON ta.created_by_id = u.id\r\nJOIN organizations o ON u.organization_id = o.id\r\nWHERE ta.created_by_id NOT IN (1)\r\n  AND ta.created_by_id <> t.customer_id\r\nGROUP BY o.name\r\nORDER BY o.name ASC;",
              "refId": "A",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ],
                "limit": 50
              }
            }
          ],
          "title": "Panel Title",
          "type": "table"
        }
      ],
      "schemaVersion": 39,
      "tags": [],
      "templating": {
        "list": []
      },
      "time": {
        "from": "now-1w/w",
        "to": "now-1w/w"
      },
      "timeRangeUpdatedDuringEditOrView": false,
      "timepicker": {},
      "timezone": "browser",
      "title": "Ticketing Analytics",
      "uid": "few68w89nur5sb",
      "version": 1,
      "weekStart": ""
    }